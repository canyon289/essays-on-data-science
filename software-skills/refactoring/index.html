
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.1">
    
    
      
        <title>Refactoring your code - Essays on Data Science</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="https://unpkg.com/mermaid@7.1.2/dist/mermaid.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-12498603-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#refactoring-your-code" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Essays on Data Science" class="md-header-nav__button md-logo" aria-label="Essays on Data Science">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Essays on Data Science
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Refactoring your code
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ericmjl/essays-on-data-science/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ericmjl/essays-on-data-science
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Essays on Data Science" class="md-nav__button md-logo" aria-label="Essays on Data Science">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Essays on Data Science
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ericmjl/essays-on-data-science/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ericmjl/essays-on-data-science
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Essays on Data Science" class="md-nav__link">
      Essays on Data Science
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../supporters/" title="A big thank you..." class="md-nav__link">
      A big thank you...
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Computing
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Computing" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Computing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../computing/recursion/" title="Recursion" class="md-nav__link">
      Recursion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Machine learning
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Machine learning" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Machine learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../machine-learning/computational-bayesian-stats/" title="An Introduction to Probability and Computational Bayesian Statistics" class="md-nav__link">
      An Introduction to Probability and Computational Bayesian Statistics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../machine-learning/markov-models/" title="Markov models" class="md-nav__link">
      Markov models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../machine-learning/message-passing/" title="Computational Representations of Message Passing" class="md-nav__link">
      Computational Representations of Message Passing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../machine-learning/reimplementing-models/" title="Reimplementing and Testing Deep Learning Models" class="md-nav__link">
      Reimplementing and Testing Deep Learning Models
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Miscellaneous
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Miscellaneous" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellaneous/dashboarding-landscape/" title="A Review of the Python Data Science Dashboarding Landscape in 2019" class="md-nav__link">
      A Review of the Python Data Science Dashboarding Landscape in 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellaneous/learning-to-learn/" title="How I Learned to Learn" class="md-nav__link">
      How I Learned to Learn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellaneous/pydata-landscape/" title="An Opinionated and Unofficial Guide to the PyData Ecosystem" class="md-nav__link">
      An Opinionated and Unofficial Guide to the PyData Ecosystem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../miscellaneous/static-sites-on-dokku/" title="Static Sites and Apps On Your Own Dokku Server" class="md-nav__link">
      Static Sites and Apps On Your Own Dokku Server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Newsletter
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Newsletter" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Newsletter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      2020
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="2020" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        <span class="md-nav__icon md-icon"></span>
        2020
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../newsletter/2020/05-may/" title="Data Science Programming May 2020 Newsletter" class="md-nav__link">
      Data Science Programming May 2020 Newsletter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../newsletter/2020/06-june/" title="Data Science Programming June 2020 Newsletter" class="md-nav__link">
      Data Science Programming June 2020 Newsletter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../newsletter/2020/07-july/" title="Data Science Programming July 2020 Newsletter" class="md-nav__link">
      Data Science Programming July 2020 Newsletter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../newsletter/2020/08-august/" title="Data Science Programming August 2020 Newsletter" class="md-nav__link">
      Data Science Programming August 2020 Newsletter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../newsletter/2020/09-september/" title="Data Science Programming September 2020 Newsletter" class="md-nav__link">
      Data Science Programming September 2020 Newsletter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Software skills
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Software skills" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Software skills
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Software Skills" class="md-nav__link">
      Software Skills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../code-formatting/" title="Formatting your code" class="md-nav__link">
      Formatting your code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../documentation/" title="Documenting your code" class="md-nav__link">
      Documenting your code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../environment-variables/" title="A Data Scientist's Guide to Environment Variables" class="md-nav__link">
      A Data Scientist's Guide to Environment Variables
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Refactoring your code
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Refactoring your code" class="md-nav__link md-nav__link--active">
      Refactoring your code
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-refactor" class="md-nav__link">
    Why refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-refactor" class="md-nav__link">
    When to refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-we-refactor" class="md-nav__link">
    How do we refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-example" class="md-nav__link">
    An example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bonus" class="md-nav__link">
    Bonus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-should-this-function-be-refactored-to" class="md-nav__link">
    Where should this function be refactored to
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-do-we-find-time-to-do-this" class="md-nav__link">
    Where do we find time to do this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concluding-words" class="md-nav__link">
    Concluding words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thank-you-for-reading" class="md-nav__link">
    Thank you for reading!
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../testing/" title="Testing your code" class="md-nav__link">
      Testing your code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Terminal
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Terminal" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Terminal
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../terminal/cli-tools/" title="Tools and Upgrades for your CLI" class="md-nav__link">
      Tools and Upgrades for your CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../terminal/pre-commits/" title="Using `pre-commit` git hooks to automate code checks" class="md-nav__link">
      Using `pre-commit` git hooks to automate code checks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Workflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Workflow" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Workflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../workflow/code-review/" title="Practicing Code Review" class="md-nav__link">
      Practicing Code Review
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../workflow/effective-commit-messages/" title="Effective Git Commits in Data Science" class="md-nav__link">
      Effective Git Commits in Data Science
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../workflow/gitflow/" title="Principled Git-based Workflow in Collaborative Data Science Projects" class="md-nav__link">
      Principled Git-based Workflow in Collaborative Data Science Projects
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#why-refactor" class="md-nav__link">
    Why refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#when-to-refactor" class="md-nav__link">
    When to refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-we-refactor" class="md-nav__link">
    How do we refactor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-example" class="md-nav__link">
    An example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bonus" class="md-nav__link">
    Bonus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-should-this-function-be-refactored-to" class="md-nav__link">
    Where should this function be refactored to
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-do-we-find-time-to-do-this" class="md-nav__link">
    Where do we find time to do this
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concluding-words" class="md-nav__link">
    Concluding words
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thank-you-for-reading" class="md-nav__link">
    Thank you for reading!
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ericmjl/essays-on-data-science/edit/master/docs/software-skills/refactoring.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="refactoring-your-code">Refactoring your code</h1>
<p>How many times have you found yourself copy/pasting code from one notebook to another?
If it the answer is "many", then this essay probably has something for you.
We're going to look at the practice of "refactoring" code,
and how it applies in a data science context.</p>
<h2 id="why-refactor">Why refactor</h2>
<p>When writing code, we <em>intend</em> to have a block of code do one thing.
As such, its multiple application should have a single source of truth.
However, the practice of copying and pasting code
gives us multiple sources of truth.
Refactoring code, thus,
gives us a way of establishing a single source of truth for our functions,
which can be called on in multiple situations.</p>
<h2 id="when-to-refactor">When to refactor</h2>
<p>The short answer is "basically whenever you find yourself hitting copy+paste"
on your keyboard.</p>
<h2 id="how-do-we-refactor">How do we refactor</h2>
<p>The steps involved are as follows.</p>
<ol>
<li>Wrap the semi-complex block of code in a function.</li>
<li>Identify what you would consider to be an "input" and "output" for the function.</li>
<li>Take specific variable names and give them more general names.</li>
</ol>
<h2 id="an-example">An example</h2>
<p>Let's take the example of a chunk of code that takes a protein sequence,
compares it to a reference sequence,
and returns all of the mutations that it has.
(We will only implemenet a naive version for the sake of pedagogy.)</p>
<div class="highlight"><pre><span></span><code><span class="n">sequence1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">sequence2</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">mutations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">letter1</span><span class="p">,</span> <span class="n">letter2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sequence1</span><span class="p">,</span> <span class="n">sequence2</span><span class="p">)):</span>
    <span class="n">mutations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{letter1}{i+1}{letter2}&quot;</span><span class="p">)</span>
<span class="n">mutations</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mutations</span><span class="p">)</span>
</code></pre></div>

<p>This more or less should accomplish what we want.
Let's now apply the ideas behind refactoring to this code block.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mutation_string</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;; &quot;</span><span class="p">):</span>
    <span class="n">mutations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">letter1</span><span class="p">,</span> <span class="n">letter2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)):</span>
        <span class="n">mutations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{letter1}{i+1}{letter2}&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;{sep}&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mutations</span><span class="p">)</span>
</code></pre></div>

<p>You'll notice the three steps coming into play.</p>
<p><strong>Firstly</strong>, we simply shifted the main logic of the code into a function definition.</p>
<p><strong>Secondly</strong>, we then generalized the function a bit,
by renaming <code>sequence1</code> and <code>sequence2</code> to what we usually intend for it to be,
a <code>sequence</code> of interest and a <code>reference</code> sequence.</p>
<p><strong>Finally</strong>, we defined those two as inputs,
alongside a keyword argument called <code>sep</code>,
which defines the separator between each mutation.</p>
<h2 id="bonus">Bonus</h2>
<p>On the basis of this function definition,
we can do some additional neat things!</p>
<p>For example, in protein sequence analysis,
our <code>reference</code> sequence is usually kept constant.
Hence, we can actually create a custom <code>mutation_string</code>
for our reference sequence using <code>functools.partial</code>
by fixing <code>reference</code> to a particular value,
thus eliminating the need to repetitively pass in the same reference string.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">protein1</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># define the string here.</span>

<span class="n">prot1_mut_string</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">mutation_string</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="n">protein1</span><span class="p">)</span>

<span class="n">protein2</span> <span class="o">=</span> <span class="o">...</span>  <span class="c1"># define the string here.</span>

<span class="n">mutstring</span> <span class="o">=</span> <span class="n">prot1_mut_string</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">protein2</span><span class="p">)</span>
</code></pre></div>

<h2 id="where-should-this-function-be-refactored-to">Where should this function be refactored to</h2>
<p>You can choose to keep it in the notebook, and that would be fine
if the function was used only in a single notebook.</p>
<p>If you find yourself needing to call on that same function from another notebook,
do the right thing and create a <code>utils.py</code> (or analogous) Python module
that lives in the same directory as the notebook.
Then, import the refactored function from <code>utils.py</code>.</p>
<p>If you feel sophisticated, you can also create a custom Python library
for your project. I will address this in a separate essay.</p>
<p>An anti-pattern, though, would be to attempt to treat the notebook as source code
and import the function from one notebook into another.
Notebooks are great for one thing:
weaving functions together into an integrarted analysis.
I'm of the opinion that we should use a tool the way it was intended,
and bring in other tools to do what we need.
In this respect, I think that DataBricks notebooks does the wrong thing
by bowing to bad human first instincts rather than encouraging productive behaviours.</p>
<h2 id="where-do-we-find-time-to-do-this">Where do we find time to do this</h2>
<p>I hear this concern, as I went through the same concerns myself.</p>
<p>Isn't it faster to just copy/paste the code?
What if I don't end up reusing the code elsewhere?
Isn't the time then wasted?</p>
<p>In thinking back to my own habits, I realized early on
that doing this was not a matter of technical ability
but rather a matter of mindset.</p>
<p>Investing the time into doing simple refactoring alongside my analyses
does take immediate time away from the analysis.
However, the deliberate practice of refactoring early on
earns back multiples of the time spent as the project progresses.</p>
<p>Moreover, if and when the project gets handed over "in production",
or at least shared with others to use,
our colleagues can spend less time is spent navigating a spaghetti-like codebase,
and more time can be spent building a proper mental model of the codebase
to build on top of.</p>
<p>On the possiblity of not reusing the code elsewhere,
I would strongly disagree.
Refactoring is not a common skill, while copy/pasting code is.
Every chance we get to refactor code is practicing the skill,
which only gets sharper and more refined as we do it more.
Hence, even for the sake of getting more practice
makes it worthwhile to do refactoring at every chance.</p>
<h2 id="concluding-words">Concluding words</h2>
<p>I hope this mini-essay demystifies the practice of code refactoring,
and gives you some ideas on how to make it part of your workflow.</p>
<h2 id="thank-you-for-reading">Thank you for reading!</h2>
<p>If you enjoyed this essay and would like to receive early-bird access to more,
<a href="https://patreon.com/ericmjl">please support me on Patreon</a>!
A coffee a month sent my way gets you <em>early</em> access to my essays
on a private URL exclusively for my supporters
as well as shoutouts on every single essay that I put out.</p>
<p>Also, I have a free monthly newsletter that I use as an outlet
to share programming-oriented data science tips and tools.
If you'd like to receive it, sign up on <a href="https://tinyletter.com/ericmjl">TinyLetter</a>!</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../environment-variables/" title="A Data Scientist's Guide to Environment Variables" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                A Data Scientist's Guide to Environment Variables
              </div>
            </div>
          </a>
        
        
          <a href="../testing/" title="Testing your code" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Testing your code
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="http://www.shortwhale.com/ericmjl" target="_blank" rel="noopener" title="www.shortwhale.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 8l-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/ericmjl" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/ericmjl" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://linkedin.com/in/ericmjl" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.aa3f9871.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
      
    
  </body>
</html>